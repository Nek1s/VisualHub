#### 1. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (Separation of Concerns)**
- **–ë—ã–ª–æ**: –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ `handlers.js`
- **–°—Ç–∞–ª–æ**: –ß–µ—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —Å–ª–æ–∏:
  - `models.js` - –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
  - `queries.js` - –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
  - `services/` - —Å–µ—Ä–≤–∏—Å—ã –≤—ã—Å–æ–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è
  - `utils/` - —É—Ç–∏–ª–∏—Ç—ã –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã

#### 2. **–ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö (`src/main/db/models.js`)**
```javascript
class FolderModel {
  static getAll() // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –ø–∞–ø–∫–∏
  static getById(id) // –ü–æ–ª—É—á–∏—Ç—å –ø–∞–ø–∫—É –ø–æ ID
  static create(name, path) // –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫—É
  static update(id, updates) // –û–±–Ω–æ–≤–∏—Ç—å –ø–∞–ø–∫—É
  static delete(id) // –£–¥–∞–ª–∏—Ç—å –ø–∞–ø–∫—É
}

class ImageModel {
  static getAll() // –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
  static getByFolderId(folderId) // –ü–æ–ª—É—á–∏—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ –ø–∞–ø–∫–µ
  static create(data) // –°–æ–∑–¥–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
  static countByFolderId(folderId) // –ü–æ–¥—Å—á–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
}
```

#### 3. **–°–ª–æ–π –∑–∞–ø—Ä–æ—Å–æ–≤ (`src/main/db/queries.js`)**
```javascript
class FolderQueries {
  static getAllWithCounts() // –ü–∞–ø–∫–∏ —Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
  static createUserFolder(name, baseDir) // –°–æ–∑–¥–∞–Ω–∏–µ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
  static deleteUserFolder(folderId, baseDir) // –£–¥–∞–ª–µ–Ω–∏–µ —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
  static syncPhysicalFolders(baseDir) // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ë–î —Å –§–°
}

class ImageQueries {
  static addImage(fileBuffer, fileName, folderId, ...) // –ó–∞–≥—Ä—É–∑–∫–∞ —Å –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π
}
```

#### 4. **–°–µ—Ä–≤–∏—Å—ã (`src/main/services/FolderService.js`)**
```javascript
class FolderService {
  async getAllFolders() // –ü–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ—Ö –ø–∞–ø–æ–∫
  async createFolder(name) // –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞–ø–∫–∏
  async deleteFolder(folderId) // –£–¥–∞–ª–µ–Ω–∏–µ –ø–∞–ø–∫–∏
  async renameFolder(folderId, newName) // –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ
  restoreSystemFolder(folderName) // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö
}
```

#### 5. **–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ —É—Ç–∏–ª–∏—Ç—ã**
- `src/main/utils/constants.js` - –≤—Å–µ –∫–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `src/main/utils/validation.js` - –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

#### 1. **–ü–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (Prepared Statements)**
- –í—Å–µ SQL –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω—ã–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è
- –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç SQL-–∏–Ω—ä–µ–∫—Ü–∏–∏
- –£–ª—É—á—à–∞–µ—Ç –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–∞—Ö

#### 2. **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ JOIN-–∑–∞–ø—Ä–æ—Å—ã**
```sql
SELECT i.*, GROUP_CONCAT(t.name) as tags
FROM images i
LEFT JOIN image_tags it ON i.id = it.imageId
LEFT JOIN tags t ON it.tagId = t.id
GROUP BY i.id
```

#### 3. **–ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∏–Ω–¥–µ–∫—Å—ã**
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤ –≤ SQLite
- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å

#### 1. **–í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
```javascript
ValidationUtils.validateFolderName(name)
ValidationUtils.validateImageExtension(fileName)
```

#### 2. **–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- Graceful degradation –ø—Ä–∏ —Å–±–æ—è—Ö
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

#### 3. **–¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏**
- –ê—Ç–æ–º–∞—Ä–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ —Å –ë–î
- Rollback –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

#### 1. **–ó–∞—â–∏—Ç–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–∞–ø–æ–∫**
- File watcher –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —É–¥–∞–ª–µ–Ω–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞–ø–∫–∏
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –Ω–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏

#### 2. **–°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö**
- –û—á–∏—Å—Ç–∫–∞ –∏–º–µ–Ω —Ñ–∞–π–ª–æ–≤ –∏ –ø–∞–ø–æ–∫
- –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ –ø–æ—Å–ª–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

```
src/main/
‚îú‚îÄ‚îÄ db/
‚îÇ   ‚îú‚îÄ‚îÄ database.js      # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
‚îÇ   ‚îú‚îÄ‚îÄ models.js        # –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ queries.js       # –ó–∞–ø—Ä–æ—Å—ã –∫ –ë–î
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îî‚îÄ‚îÄ FolderService.js # –ë–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞ –ø–∞–ø–æ–∫
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ constants.js     # –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ validation.js    # –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ ipc/
‚îÇ   ‚îú‚îÄ‚îÄ handlers.js      # –°—Ç–∞—Ä—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îÇ   ‚îî‚îÄ‚îÄ handlers_optimized.js # –ù–æ–≤—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îî‚îÄ‚îÄ main.js              # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```